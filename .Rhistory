devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=F,
celltype=T,
ncores = 2,
split_n=1)
##------ Sun May 22 11:23:51 2022 ------##
##------ Sun May 22 11:23:56 2022 ------##
##------ Sun May 22 11:24:09 2022 ------##
##------ Sun May 22 11:24:09 2022 ------##
##------ Sun May 22 11:24:10 2022 ------##
##------ Sun May 22 11:24:11 2022 ------##
##------ Sun May 22 11:24:28 2022 ------##
##------ Sun May 22 11:24:29 2022 ------##
##------ Sun May 22 11:24:35 2022 ------##
names(Pagwas_data)
head(Pagwas$CellsrankPvalue)
Pagwas <- list();
Single_data=readRDS(Single_data)
Single_data
Pagwas <- Single_data_input(Pagwas=Pagwas,
assay=assay,
#nfeatures =nfeatures,
Single_data=Single_data,
Pathway_list=Pathway_list,
min_clustercells=min_clustercells)
Single_data<-Single_data[,colnames(Pagwas$data_mat)]
Pagwas <- Pathway_pcascore_run(Pagwas=Pagwas,
Pathway_list=Pathway_list,
min.pathway.size=min.pathway.size,
max.pathway.size=max.pathway.size
)
suppressMessages(gwas_data <- bigreadr::fread2(gwas_data))
head(gwas_data)
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas");
message("** Start to read the gwas_data!")
suppressMessages(gwas_data <- bigreadr::fread2(gwas_data))
Pagwas <- GWAS_summary_input(Pagwas=Pagwas,
gwas_data=gwas_data,
maf_filter=maf_filter)
snp_gene_df<-Snp2Gene(snp=Pagwas$gwas_data,refGene=block_annotation,marg=marg)
snp_gene_df$slope <- rep(1,nrow(snp_gene_df))
Pagwas$snp_gene_df<-snp_gene_df[snp_gene_df$Disstance=="0",]
Pagwas <- Pathway_annotation_input(Pagwas=Pagwas,
block_annotation=block_annotation)
Pagwas <- Link_pathway_blocks_gwas(Pagwas=Pagwas,
chrom_ld=chrom_ld,
split_n=split_n,
singlecell=singlecell,
celltype=celltype,
ncores=ncores)
Pagwas$lm_results <- Pagwas_perform_regression(Pathway_ld_gwas_data=Pagwas$Pathway_ld_gwas_data)
Pagwas <- Boot_evaluate(Pagwas,bootstrap_iters = iters, part = 0.5)
Pagwas<-scPagwas_perform_score(Pagwas=Pagwas,
remove_outlier=TRUE)
names(Pagwas)
?p.adjust
Pagwas$CellsrankPvalue$fdr.adj.p<-p.adjust(Pagwas$CellsrankPvalue$pValueHigh,method ="fdr" )
sum(Pagwas$CellsrankPvalue$fdr.adj.p<0.05)
sum(Pagwas$CellsrankPvalue$pValueHigh<0.05)
length(Pagwas$CellsrankPvalue$pValueHigh)
Pagwas$CellsrankPvalue$fdr.adj.p<-p.adjust(Pagwas$CellsrankPvalue$pValueHigh,
method ="bonferroni" )
sum(Pagwas$CellsrankPvalue$fdr.adj.p<0.05)
Single_data
Single_data$scPagwas.lm.score<-Pagwas$scPagwas_score[rownames(Pagwas$Celltype_anno)]
Single_data$Cells.lm.rankPvalue<-Pagwas$CellsrankPvalue[rownames(Pagwas$Celltype_anno),"pValueHigh"]
Single_data$Cells.lm.adjp<-Pagwas$CellsrankPvalue[rownames(Pagwas$Celltype_anno),"adj.p"]
Pagwas$CellsrankPvalue[rownames(Pagwas$Celltype_anno),"adj.p"]
head(Pagwas$CellsrankPvalue)
Pagwas$CellsrankPvalue$adj.p<-p.adjust(Pagwas$CellsrankPvalue$pValueHigh,
method ="bonferroni" )
Single_data$Cells.lm.adjp<-Pagwas$CellsrankPvalue[rownames(Pagwas$Celltype_anno),"adj.p"]
Single_data$Cells.lm.adjp
devtools::load_all(".")
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
#1.start to run the wrapper functions for preprogress.
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Sun May 22 11:55:27 2022 ------##
##------ Sun May 22 11:55:33 2022 ------##
##------ Sun May 22 11:55:45 2022 ------##
##------ Sun May 22 11:55:45 2022 ------##
##------ Sun May 22 11:55:46 2022 ------##
##------ Sun May 22 11:55:48 2022 ------##
##------ Sun May 22 11:56:05 2022 ------##
##------ Sun May 22 11:56:06 2022 ------##
##------ Sun May 22 11:56:11 2022 ------##
Pagwas_data
head(Pagwas_data@meta.data)
library(Seurat)
library(parallel)
#library(SeuratData)
data(Genes_by_pathway_kegg)
data(block_annotation)
data(chrom_ld)
Pagwas_seu<-scPagwas_main(Pagwas = NULL,
gwas_data ="E:/RPakage/scPagwas/inst/extdata/AD_prune_gwas_data.txt",
output.prefix="adPrunetest",
output.dirs="adPrunetest",
block_annotation = block_annotation,
assay="RNA",
Single_data ="E:/RPakage/scPagwas/inst/extdata/GSE138852_ad.rds",##or input the rds files
split_n=1,
ncores=5,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
celltype=T)
##------ Sun May 22 12:00:28 2022 ------##
##------ Sun May 22 12:00:32 2022 ------##
##------ Sun May 22 12:00:44 2022 ------##
##------ Sun May 22 12:00:45 2022 ------##
##------ Sun May 22 12:00:46 2022 ------##
##------ Sun May 22 12:00:48 2022 ------##
##------ Sun May 22 12:01:06 2022 ------##
##------ Sun May 22 12:01:07 2022 ------##
##------ Sun May 22 12:01:12 2022 ------##
Pagwas_seu
DimPlot(Pagwas,reduction="tsne",group.by = "oupSample.cellType",pt.size=0.8,
label = TRUE, repel=TRUE)+ labs(x="TSNE",y="")+
scale_color_d3() +
theme(aspect.ratio=1)
require("RColorBrewer")
require("SeuratObject")
require("ggsci")
library("RColorBrewer")
library("ggplot2")
DimPlot(Pagwas,reduction="tsne",group.by = "oupSample.cellType",pt.size=0.8,
label = TRUE, repel=TRUE)+ labs(x="TSNE",y="")+
scale_color_d3() +
theme(aspect.ratio=1)
scPagwas_Visualization(Single_data=Pagwas,
p_thre = 0.05,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#000957",
highColor = "#EBE645",
output.dirs="adPrunetest",
size = 0.5,
do_plot = T)
DimPlot(Pagwas_seu,reduction="tsne",group.by = "oupSample.cellType",pt.size=0.8,
label = TRUE, repel=TRUE)+ labs(x="TSNE",y="")+
scale_color_d3() +
theme(aspect.ratio=1)
Pagwas_seu
DimPlot(Pagwas_seu,reduction="umap",group.by = "oupSample.cellType",pt.size=0.8,
label = TRUE, repel=TRUE)+ labs(x="TSNE",y="")+
scale_color_d3() +
theme(aspect.ratio=1)
Pagwas_seu<-scPagwas_main(Pagwas = NULL,
gwas_data ="E:/RPakage/scPagwas/inst/extdata/AD_prune_gwas_data.txt",
output.prefix="adPrunetest",
output.dirs="adPrunetest",
block_annotation = block_annotation,
assay="RNA",
Single_data ="E:/RPakage/scPagwas/inst/extdata/GSE138852_ad.rds",##or input the rds files
split_n=1,
ncores=5,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
celltype=T)
##------ Sun May 22 12:05:10 2022 ------##
##------ Sun May 22 12:05:15 2022 ------##
Pagwas_seu<-scPagwas_main(Pagwas = NULL,
gwas_data ="E:/RPakage/scPagwas/inst/extdata/AD_prune_gwas_data.txt",
output.prefix="adPrunetest",
output.dirs="adPrunetest",
block_annotation = block_annotation,
assay="RNA",
Single_data ="E:/RPakage/scPagwas/inst/extdata/GSE138852_ad.rds",##or input the rds files
split_n=1,
ncores=5,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
celltype=T)
##------ Sun May 22 12:05:17 2022 ------##
##------ Sun May 22 12:05:22 2022 ------##
Single_data =readRDS("E:/RPakage/scPagwas/inst/extdata/GSE138852_ad.rds")
Single_data
Pagwas_seu<-scPagwas_main(Pagwas = NULL,
gwas_data ="E:/RPakage/scPagwas/inst/extdata/AD_prune_gwas_data.txt",
output.prefix="adPrunetest",
output.dirs="adPrunetest",
block_annotation = block_annotation,
assay="RNA",
Single_data ="E:/RPakage/scPagwas/inst/extdata/GSE138852_ad.rds",
split_n=1,
ncores=5,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
celltype=T)
##------ Sun May 22 12:06:05 2022 ------##
##------ Sun May 22 12:06:10 2022 ------##
devtools::load_all(".")
gc()
library(Seurat)
library(parallel)
#library(SeuratData)
data(Genes_by_pathway_kegg)
data(block_annotation)
data(chrom_ld)
Pagwas_seu<-scPagwas_main(Pagwas = NULL,
gwas_data ="E:/RPakage/scPagwas/inst/extdata/AD_prune_gwas_data.txt",
output.prefix="adPrunetest",
output.dirs="adPrunetest",
block_annotation = block_annotation,
assay="RNA",
Single_data ="E:/RPakage/scPagwas/inst/extdata/GSE138852_ad.rds",
split_n=1,
ncores=5,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
celltype=T)
##------ Sun May 22 12:07:01 2022 ------##
##------ Sun May 22 12:07:09 2022 ------##
##------ Sun May 22 12:07:38 2022 ------##
##------ Sun May 22 12:08:21 2022 ------##
##------ Sun May 22 12:08:44 2022 ------##
##------ Sun May 22 12:08:46 2022 ------##
##------ Sun May 22 12:27:30 2022 ------##
##------ Sun May 22 12:30:14 2022 ------##
##------ Sun May 22 12:30:40 2022 ------##
devtools::document()
renv::snapshot()
devtools::document()
library(scPagwas)
styler::style_pkg()
devtools::check()
devtools::document()
library(scPagwas)
library(scPagwas)
library(ggplot2)
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
#1.start to run the wrapper functions for preprogress.
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Mon May 23 12:04:33 2022 ------##
##------ Mon May 23 12:04:38 2022 ------##
##------ Mon May 23 12:04:45 2022 ------##
##------ Mon May 23 12:04:45 2022 ------##
##------ Mon May 23 12:04:46 2022 ------##
##------ Mon May 23 12:04:48 2022 ------##
##------ Mon May 23 12:05:15 2022 ------##
##------ Mon May 23 12:05:17 2022 ------##
##------ Mon May 23 12:05:22 2022 ------##
devtools::document()
library(scPagwas)
devtools::load_all(".")
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Tue May 24 13:03:42 2022 ------##
##------ Tue May 24 13:03:49 2022 ------##
##------ Tue May 24 13:04:02 2022 ------##
##------ Tue May 24 13:04:02 2022 ------##
##------ Tue May 24 13:04:03 2022 ------##
##------ Tue May 24 13:04:04 2022 ------##
##------ Tue May 24 13:04:23 2022 ------##
##------ Tue May 24 13:04:25 2022 ------##
##------ Tue May 24 13:04:29 2022 ------##
devtools::load_all(".")
library(ggplot2)
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Wed May 25 16:23:07 2022 ------##
##------ Wed May 25 16:23:14 2022 ------##
##------ Wed May 25 16:23:29 2022 ------##
##------ Wed May 25 16:23:29 2022 ------##
##------ Wed May 25 16:23:30 2022 ------##
##------ Wed May 25 16:23:31 2022 ------##
##------ Wed May 25 16:23:49 2022 ------##
##------ Wed May 25 16:23:51 2022 ------##
?qvalue
??qvalue
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Wed May 25 16:41:16 2022 ------##
##------ Wed May 25 16:41:23 2022 ------##
##------ Wed May 25 16:41:39 2022 ------##
##------ Wed May 25 16:41:39 2022 ------##
##------ Wed May 25 16:41:39 2022 ------##
##------ Wed May 25 16:41:41 2022 ------##
##------ Wed May 25 16:41:56 2022 ------##
##------ Wed May 25 16:41:58 2022 ------##
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Wed May 25 16:52:31 2022 ------##
##------ Wed May 25 16:52:36 2022 ------##
##------ Wed May 25 16:52:45 2022 ------##
##------ Wed May 25 16:52:46 2022 ------##
##------ Wed May 25 16:52:46 2022 ------##
##------ Wed May 25 16:52:47 2022 ------##
##------ Wed May 25 16:53:03 2022 ------##
##------ Wed May 25 16:53:04 2022 ------##
devtools::load_all(".")
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Wed May 25 16:55:35 2022 ------##
##------ Wed May 25 16:55:39 2022 ------##
##------ Wed May 25 16:55:54 2022 ------##
##------ Wed May 25 16:55:55 2022 ------##
##------ Wed May 25 16:55:55 2022 ------##
##------ Wed May 25 16:55:56 2022 ------##
##------ Wed May 25 16:56:12 2022 ------##
##------ Wed May 25 16:56:14 2022 ------##
##------ Wed May 25 16:56:18 2022 ------##
Single_data =readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
Single_data
Single_data@assays$RNA
GetAssayData(Single_data,assay = "RNA")
Pagwas_data
Pagwas_data@misc$gene_heritability_correlation
head(Pagwas_data@misc$gene_heritability_correlation)
devtools::load_all(".")
library(ggplot2)
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
#1.start to run the wrapper functions for preprogress.
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Wed May 25 20:39:07 2022 ------##
##------ Wed May 25 20:39:12 2022 ------##
##------ Wed May 25 20:39:27 2022 ------##
##------ Wed May 25 20:39:27 2022 ------##
##------ Wed May 25 20:39:28 2022 ------##
##------ Wed May 25 20:39:29 2022 ------##
##------ Wed May 25 20:39:46 2022 ------##
##------ Wed May 25 20:39:47 2022 ------##
##------ Wed May 25 20:39:51 2022 ------##
devtools::load_all(".")
library(ggplot2)
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
#1.start to run the wrapper functions for preprogress.
Pagwas_data<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
output.prefix="test",
output.dirs="scPagwastest_output",
block_annotation = block_annotation,
assay="RNA",
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld,
singlecell=T,
seruat_return=T,
celltype=T,
ncores = 2,
split_n=1)
##------ Wed May 25 20:45:17 2022 ------##
##------ Wed May 25 20:45:21 2022 ------##
##------ Wed May 25 20:45:35 2022 ------##
##------ Wed May 25 20:45:35 2022 ------##
##------ Wed May 25 20:45:36 2022 ------##
##------ Wed May 25 20:45:37 2022 ------##
##------ Wed May 25 20:45:54 2022 ------##
##------ Wed May 25 20:45:55 2022 ------##
##------ Wed May 25 20:46:00 2022 ------##
?rank
