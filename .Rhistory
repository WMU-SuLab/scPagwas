noise_per_snp = noise_per_snp[!na_elements]
))
}
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=3,
part = 0.5,
SimpleResult=F)
library(scPagwas)
library(scPagwas)
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
#1.start to run the wrapper functions for preprogress.
Pagwas<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
output.prefix="test",
add_eqtls="OnlyTSS",
block_annotation = block_annotation,
assay="RNA",
Single_data = system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
nfeatures =NULL,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld)
##------ Tue Apr 26 09:54:20 2022 ------##
##------ Tue Apr 26 09:54:22 2022 ------##
##------ Tue Apr 26 09:54:30 2022 ------##
##------ Tue Apr 26 09:54:30 2022 ------##
##------ Tue Apr 26 09:54:31 2022 ------##
##------ Tue Apr 26 09:54:32 2022 ------##
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=3,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
library("RColorBrewer")
library("ggplot2")
scPagwas_score <- Pagwas$scPagwas_score[intersect(colnames(scRNAexample),names(Pagwas$scPagwas_score))]
scRNAexample$scPagwas_score <- scPagwas_score
thre <- sort(scRNAexample$scPagwas_score, decreasing = T)[ncol(scRNAexample) * 0.1]
scRNAexample$positiveCells<-rep(0,ncol(scRNAexample))
scRNAexample$positiveCells[scRNAexample$scPagwas_score>=thre]<-1
plot_bar_positie_nagtive(seurat_obj=scRNAexample,
var_ident="positiveCells",
var_group="anno",
vec_group_colors=NULL,
f_color=colorRampPalette(brewer.pal(n=10, name="RdYlBu")),
do_plot = T)
plot_bar_positie_nagtive(seurat_obj=scRNAexample,
var_ident="anno",
var_group="positiveCells",
vec_group_colors=c("#E8D0B3","#7EB5A6"),
do_plot = T)
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=4,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
library("RColorBrewer")
library("ggplot2")
scPagwas_score <- Pagwas$scPagwas_score[intersect(colnames(scRNAexample),names(Pagwas$scPagwas_score))]
scRNAexample$scPagwas_score <- scPagwas_score
thre <- sort(scRNAexample$scPagwas_score, decreasing = T)[ncol(scRNAexample) * 0.1]
scRNAexample$positiveCells<-rep(0,ncol(scRNAexample))
scRNAexample$positiveCells[scRNAexample$scPagwas_score>=thre]<-1
plot_bar_positie_nagtive(seurat_obj=scRNAexample,
var_ident="positiveCells",
var_group="anno",
vec_group_colors=NULL,
f_color=colorRampPalette(brewer.pal(n=10, name="RdYlBu")),
do_plot = T)
plot_bar_positie_nagtive(seurat_obj=scRNAexample,
var_ident="anno",
var_group="positiveCells",
vec_group_colors=c("#E8D0B3","#7EB5A6"),
do_plot = T)
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=3,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=2,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=5,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
library("RColorBrewer")
library("ggplot2")
scPagwas_score <- Pagwas$scPagwas_score[intersect(colnames(scRNAexample),names(Pagwas$scPagwas_score))]
scRNAexample$scPagwas_score <- scPagwas_score
thre <- sort(scRNAexample$scPagwas_score, decreasing = T)[ncol(scRNAexample) * 0.1]
scRNAexample$positiveCells<-rep(0,ncol(scRNAexample))
scRNAexample$positiveCells[scRNAexample$scPagwas_score>=thre]<-1
plot_bar_positie_nagtive(seurat_obj=scRNAexample,
var_ident="positiveCells",
var_group="anno",
vec_group_colors=NULL,
f_color=colorRampPalette(brewer.pal(n=10, name="RdYlBu")),
do_plot = T)
plot_bar_positie_nagtive(seurat_obj=scRNAexample,
var_ident="anno",
var_group="positiveCells",
vec_group_colors=c("#E8D0B3","#7EB5A6"),
do_plot = T)
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=6,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=7,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
library("RColorBrewer")
library("ggplot2")
scPagwas_score <- Pagwas$scPagwas_score[intersect(colnames(scRNAexample),names(Pagwas$scPagwas_score))]
scRNAexample$scPagwas_score <- scPagwas_score
thre <- sort(scRNAexample$scPagwas_score, decreasing = T)[ncol(scRNAexample) * 0.1]
scRNAexample$positiveCells<-rep(0,ncol(scRNAexample))
scRNAexample$positiveCells[scRNAexample$scPagwas_score>=thre]<-1
plot_bar_positie_nagtive(seurat_obj=scRNAexample,
var_ident="positiveCells",
var_group="anno",
vec_group_colors=NULL,
f_color=colorRampPalette(brewer.pal(n=10, name="RdYlBu")),
do_plot = T)
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=8,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
Single_data = readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
Single_data<-Single_data[,1:999]
Single_data = saveRDS(Single_data,file = "E:/OneDrive/GWAS_Multiomics/CelltypesRerun/scRNAexample.rds")
Single_data
Single_data
Single_data = readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
Single_data
Single_data[,1:999]
Single_data<-Single_data[,1:999]
Single_data
saveRDS(Single_data,file = "E:/OneDrive/GWAS_Multiomics/CelltypesRerun/scRNAexample.rds")
library(scPagwas)
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
#Single_data = readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
#Single_data<-Single_data[,1:999]
#saveRDS(Single_data,file = "E:/OneDrive/GWAS_Multiomics/CelltypesRerun/scRNAexample.rds")
#1.start to run the wrapper functions for preprogress.
Pagwas<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
output.prefix="test",
add_eqtls="OnlyTSS",
block_annotation = block_annotation,
assay="RNA",
Single_data ="E:/OneDrive/GWAS_Multiomics/CelltypesRerun/scRNAexample.rds",# system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
nfeatures =NULL,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld)
##------ Tue Apr 26 10:06:14 2022 ------##
##------ Tue Apr 26 10:06:15 2022 ------##
##------ Tue Apr 26 10:06:26 2022 ------##
##------ Tue Apr 26 10:06:26 2022 ------##
##------ Tue Apr 26 10:06:26 2022 ------##
##------ Tue Apr 26 10:06:27 2022 ------##
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=3,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
gcd <-
function(x,y){
gcd <- 1
liste <- NULL
a <- prime.factor(x)
b <- prime.factor(y)
a1 <- unique(a)
b1 <- unique(b)
c <- length(a1)
d <- length(b1)
if(c<d){
gemeinsam <- is.element(a1,b1)
switch <- a1
}else{
gemeinsam <- is.element(b1,a1)
switch <- b1
}
gem.l <- length(gemeinsam)
start <- 1
end <- gem.l+1
while(start<end){
if(gemeinsam[start]==TRUE){
liste <- c(liste, switch[start])
}
start <- start+1
}
liste.l <- length(liste)
start <-1
end <- liste.l+1
while(start<end){
dieser <- liste[start]
test1 <- sum(as.integer(is.element(a, dieser)))
test2 <- sum(as.integer(is.element(b, dieser)))
if(test1<test2){
zwischen <- liste[start]^test1
}else{
zwischen <- liste[start]^test2
}
gcd <- gcd*zwischen
start <- start+1
}
return(gcd)
}
6%%2
6%%4
20%%4
20%%3
50%%3
split_n
split_n<-4
a<-999
split_n + a%%split_n
999/7
a%%split_n
split_n
a
for (ai in 1:5) {
if(a%%split_n==0) break;
split_n <- split_n+1
}
split_n
split_n<-4
a
for (ai in 1:10) {
print(ai)
if(a%%split_n==0) break;
split_n <- split_n+1
}
split_n
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=2,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
library(scPagwas)
suppressMessages(library(Seurat))
suppressMessages(library("dplyr"))
#Input pathway gene list, you can construct with youself.
data(Genes_by_pathway_kegg)
#gene annotation files.
data(block_annotation)
#LD data
data(chrom_ld)
#1.start to run the wrapper functions for preprogress.
Pagwas<-scPagwas_main(Pagwas = NULL,
gwas_data =system.file("extdata", "GWAS_summ_example.txt", package = "scPagwas"),
output.prefix="test",
add_eqtls="OnlyTSS",
block_annotation = block_annotation,
assay="RNA",
Single_data =system.file("extdata", "scRNAexample.rds", package = "scPagwas"),
nfeatures =NULL,
Pathway_list=Genes_by_pathway_kegg,
chrom_ld = chrom_ld)
##------ Tue Apr 26 10:58:14 2022 ------##
##------ Tue Apr 26 10:58:15 2022 ------##
##------ Tue Apr 26 10:58:25 2022 ------##
##------ Tue Apr 26 10:58:25 2022 ------##
##------ Tue Apr 26 10:58:26 2022 ------##
##------ Tue Apr 26 10:58:27 2022 ------##
Pagwas<-Singlecell_heritability_contributions(Pagwas,
n.cores=1,
split_n=3,
part = 0.5,
SimpleResult=F)
require("RColorBrewer")
require("Seurat")
require("SeuratObject")
require("ggsci")
#check the objects
#Single_data<-FindVariableFeatures(Single_data)
scRNAexample<-readRDS(system.file("extdata", "scRNAexample.rds", package = "scPagwas"))
scPagwas_Visualization(scPagwas_score = Pagwas$scPagwas_score,
Single_data = scRNAexample,
Reduction = TRUE,
assay = "SCT",
cellpercent = 0.1,
filename = NULL,
FigureType = "tsne",
width = 7,
height = 7,
lowColor = "#FFBC80", highColor = "#FC4F4F",
size = 1,
title = "scPagwas_score",
do_plot = T)
