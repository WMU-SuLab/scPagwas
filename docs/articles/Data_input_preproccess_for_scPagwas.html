<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data_input_preproccess_for_scPagwas • scPagwas</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data_input_preproccess_for_scPagwas">
<meta property="og:description" content="scPagwas">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12345678-0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-12345678-0');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scPagwas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Bmmc_monocytecount_singlecell_celltype_vignette.html">Bmmc_monocytecount_singlecell_celltype_vignette</a>
    </li>
    <li>
      <a href="../articles/Data_input_preproccess_for_scPagwas.html">Data_input_preproccess_for_scPagwas</a>
    </li>
    <li>
      <a href="../articles/Multi_TraitFiles_for_one_SingleData_running.html">Multi_TraitFiles_for_one_SingleData_running</a>
    </li>
    <li>
      <a href="../articles/Running_scPagwas_steps_by_SubFunctions.html">Running_scPagwas_steps_by_SubFunctions</a>
    </li>
    <li>
      <a href="../articles/Split_big_scRNAseqData_and_integrate_result.html">Split_big_scRNAseqData_and_integrate_result</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data_input_preproccess_for_scPagwas</h1>
            
            <h4 data-toc-skip class="date">Last Updated: 14, 七月, 2022 at 13:18</h4>
      
      
      <div class="hidden name"><code>Data_input_preproccess_for_scPagwas.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="data-input">Data input<a class="anchor" aria-label="anchor" href="#data-input"></a>
</h2>
<p>There were three input resources for scPagwas: scRNA-seq dataset(seruat format), a GWAS summary dataset(txt file) on a given phenotype and an extensive panel of pathways or functional gene sets(gene symbol list).</p>
<div class="section level3">
<h3 id="single-cell-data-input">1.Single cell data Input<a class="anchor" aria-label="anchor" href="#single-cell-data-input"></a>
</h3>
<p>The healthy BMMC scRNA-seq dataset was downloaded from the website: <a href="https://jeffgranja.s3.amazonaws.com/MPAL-10x/Supplementary_Data/Healthy-Data/scRNA-Healthy-Hematopoiesis-191120.rds" class="external-link uri">https://jeffgranja.s3.amazonaws.com/MPAL-10x/Supplementary_Data/Healthy-Data/scRNA-Healthy-Hematopoiesis-191120.rds</a></p>
<ul>
<li>1). The scRNA-seq dataset should have Idents for cell types or clusters.</li>
<li>2). The scRNA-seq dataset should be normalized.</li>
</ul>
<div class="section level4">
<h4 id="read-the-scrna-seq-datasetseruat-format">1.1.read the scRNA-seq dataset(seruat format)<a class="anchor" aria-label="anchor" href="#read-the-scrna-seq-datasetseruat-format"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"scPagwas"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://satijalab.org/seurat" class="external-link">"Seurat"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"scRNAseq"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"SingleCellExperiment"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://stringr.tidyverse.org" class="external-link">"stringr"</a></span><span class="op">)</span> 
<span class="va">scRNA_Healthy_Hema</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"E:/OneDrive/SingleCell/data/PBMCscATAC-seq/scRNA-Healthy-Hematopoiesis-191120.rds"</span><span class="op">)</span></code></pre></div>
<p>Because the Example data <code>scRNA_Healthy_Hema</code> is SingleCellExperiment format, here creating a seruat format data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">scRNA_Healthy_Hema</span>, <span class="st">"counts"</span><span class="op">)</span>
<span class="va">Seu_Healthy_Hema</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span>
               counts <span class="op">=</span> <span class="va">counts</span>, 
               meta.data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">scRNA_Healthy_Hema</span><span class="op">)</span><span class="op">)</span>,
               min.cells <span class="op">=</span> <span class="fl">3</span>, 
               min.features <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="set-idents">1.2.Set Idents<a class="anchor" aria-label="anchor" href="#set-idents"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Idents</span>(Seu_Healthy_Hema)<span class="ot">&lt;-</span>scRNA_Healthy_Hema<span class="sc">@</span>colData<span class="sc">$</span>BioClassification</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">Idents</span>(Seu_Healthy_Hema))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        01_HSC 02_Early.Eryth  03_Late.Eryth  04_Early.Baso    05_CMP.LMPP       06_CLP<span class="fl">.1</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1425</span>           <span class="dv">1653</span>            <span class="dv">446</span>            <span class="dv">111</span>           <span class="dv">2260</span>            <span class="dv">903</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        07_GMP    08_GMP.Neut         09_pDC         10_cDC 11_CD14.Mono<span class="fl">.1</span> 12_CD14.Mono<span class="fl">.2</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2097</span>           <span class="dv">1050</span>            <span class="dv">544</span>            <span class="dv">325</span>           <span class="dv">1800</span>           <span class="dv">4222</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  13_CD16.Mono         14_Unk       15_CLP<span class="fl">.2</span>       16_Pre.B           17_B      18_Plasma </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>           <span class="dv">292</span>            <span class="dv">520</span>            <span class="dv">377</span>            <span class="dv">710</span>           <span class="dv">1711</span>             <span class="dv">62</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      19_CD8.N      20_CD4.N1      21_CD4.N2       22_CD4.M      23_CD8.EM      24_CD8.CM </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1521</span>           <span class="dv">2470</span>           <span class="dv">2364</span>           <span class="dv">3539</span>            <span class="dv">796</span>           <span class="dv">2080</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>         25_NK         26_Unk </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>          <span class="dv">2143</span>            <span class="dv">161</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="normalized">1.3.Normalized<a class="anchor" aria-label="anchor" href="#normalized"></a>
</h4>
<p>Scale and Normalize the dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Seu_Healthy_Hema</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">Seu_Healthy_Hema</span><span class="op">)</span>
<span class="va">Seu_Healthy_Hema</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">Seu_Healthy_Hema</span>, normalization.method <span class="op">=</span> <span class="st">"LogNormalize"</span>, scale.factor <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></code></pre></div>
<p>The BMMC processed scRNA-seq data can download from here: <a href="https://1drv.ms/u/s!As-aKqXDnDUHi9pNciEgQFbe-AHgLw?e=3XsNnQ" class="external-link uri">https://1drv.ms/u/s!As-aKqXDnDUHi9pNciEgQFbe-AHgLw?e=3XsNnQ</a></p>
</div>
</div>
<div class="section level3">
<h3 id="gwas-summary-data-input">2.GWAS summary data Input<a class="anchor" aria-label="anchor" href="#gwas-summary-data-input"></a>
</h3>
<p>GWAS Summary statistics are download from: <a href="ftp://ftp.sanger.ac.uk/pub/project/humgen/summary_statistics/UKBB_blood_cell_traits/" class="uri">ftp://ftp.sanger.ac.uk/pub/project/humgen/summary_statistics/UKBB_blood_cell_traits/</a> for UK Biobank.</p>
<ul>
<li>basophil cell count: ieu-b-29</li>
<li>eosinophil cell count : ieu-b-33</li>
<li>lymphocyte cell count: ebi-a-GCST004627</li>
<li>monocyte cell count: ieu-b-31</li>
<li>neutrophil cell count: ieu-b-34</li>
<li>white blood cell count: ieu-b-30</li>
<li>Lymphocyte percentage of white cells: ebi-a-GCST004632</li>
<li>Hemoglobin concentration: ebi-a-GCST90002311</li>
<li>Mean corpuscular hemoglobin concentration: ebi-a-GCST90002329</li>
<li>Mean corpuscular volume: ebi-a-GCST90002335</li>
</ul>
<p>The GWAS Summary statistics file need to be processed into a “txt” file including six coloumn and tab-delimited.</p>
<div class="section level4">
<h4 id="check-the-example-gwas-summary-statistics-file">2.1.Check the example GWAS Summary statistics file<a class="anchor" aria-label="anchor" href="#check-the-example-gwas-summary-statistics-file"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scPagwas</span><span class="op">)</span>
<span class="va">gwas_data</span> <span class="op">&lt;-</span> <span class="fu">bigreadr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bigreadr/man/fread2.html" class="external-link">fread2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GWAS_summ_example.txt"</span>, package <span class="op">=</span> <span class="st">"scPagwas"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gwas_data</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">chrom</th>
<th align="right">pos</th>
<th align="left">rsid</th>
<th align="right">se</th>
<th align="right">beta</th>
<th align="right">maf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">6</td>
<td align="right">119968580</td>
<td align="left">rs1159767</td>
<td align="right">0.0329339</td>
<td align="right">0.0193056</td>
<td align="right">0.5275</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">130566523</td>
<td align="left">rs559109</td>
<td align="right">0.0339840</td>
<td align="right">0.0454866</td>
<td align="right">0.4047</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">133328825</td>
<td align="left">rs6893145</td>
<td align="right">0.0486105</td>
<td align="right">0.1447440</td>
<td align="right">0.1222</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">146652932</td>
<td align="left">rs13228798</td>
<td align="right">0.0350390</td>
<td align="right">0.0039275</td>
<td align="right">0.3211</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">23373027</td>
<td align="left">rs4400806</td>
<td align="right">0.0323868</td>
<td align="right">0.0108843</td>
<td align="right">0.4604</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">168561511</td>
<td align="left">rs1421766</td>
<td align="right">0.0324148</td>
<td align="right">0.0260761</td>
<td align="right">0.5182</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="take-the-monocyte-count-as-real-example-and-deal-with-it-step-by-step">2.2.Take the monocyte count as real example and deal with it step by step:<a class="anchor" aria-label="anchor" href="#take-the-monocyte-count-as-real-example-and-deal-with-it-step-by-step"></a>
</h4>
<p>Preprogress the raw monocytecount GWAS Summary statistics file. Extract the useful information from raw files. Download the Raw gwas GWAS Summary statistics file: <a href="https://gwas.mrcieu.ac.uk/files/ieu-b-31/ieu-b-31.vcf.gz" class="external-link uri">https://gwas.mrcieu.ac.uk/files/ieu-b-31/ieu-b-31.vcf.gz</a></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span>
<span class="co">############read the raw vcf file</span>
<span class="va">monocytecount</span><span class="op">&lt;-</span><span class="st">"ieu-b-31.vcf.gz"</span>
<span class="va">GWAS_raw</span> <span class="op">&lt;-</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html" class="external-link">read_table2</a></span><span class="op">(</span><span class="va">monocytecount</span>,comment <span class="op">=</span> <span class="st">"#"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">GWAS_raw</span> <span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CHROM"</span>,<span class="st">"POS"</span>,<span class="st">"ID"</span>,<span class="st">"REF"</span>,<span class="st">"ALT"</span>,<span class="st">"QUAL"</span>,<span class="st">"FILTER"</span>,<span class="st">"INFO"</span>,<span class="st">"FORMAT"</span>,<span class="st">"IEU"</span><span class="op">)</span>
<span class="co">#ES:SE:LP:AF:SS:ID</span>
<span class="co">#ieu-a type of file:split the FORMAT and IEU coloumn, which including different information.</span>
<span class="va">value_list</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">GWAS_raw</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span>
  <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">GWAS_raw</span><span class="op">$</span><span class="va">FORMAT</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">":"</span>,fixed<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
  <span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">GWAS_raw</span><span class="op">$</span><span class="va">IEU</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">":"</span>,fixed<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">&lt;-</span><span class="va">index</span>
  <span class="va">value</span><span class="op">&lt;-</span><span class="va">value</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ES"</span>,<span class="st">"SE"</span>,<span class="st">"LP"</span>,<span class="st">"AF"</span>,<span class="st">"SS"</span><span class="op">)</span><span class="op">]</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>

 <span class="va">value_df</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">value_list</span><span class="op">)</span><span class="op">)</span>,byrow<span class="op">=</span><span class="cn">T</span>,ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
 <span class="va">value_df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">value_df</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">value_df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ES"</span>,<span class="st">"SE"</span>,<span class="st">"LP"</span>,<span class="st">"AF"</span>,<span class="st">"SS"</span><span class="op">)</span>
 <span class="va">gwas_data</span><span class="op">&lt;-</span><span class="va">GWAS_raw</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>
 <span class="va">gwas_data</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">gwas_data</span>,<span class="va">value_df</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gwas_data</span><span class="op">)</span>
<span class="co">#[1] "CHROM" "POS"   "ID"    "REF"   "ALT"   "ES"    "SE"    "LP"    "AF"   </span>
<span class="co">#[10] "SS"</span>
<span class="co">#change the colnames:</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gwas_data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chrom"</span>,<span class="st">"pos"</span>,<span class="st">"rsid"</span>,<span class="st">"REF"</span>,<span class="st">"ALT"</span>,<span class="st">"beta"</span>,<span class="st">"se"</span>,<span class="st">"maf"</span>,<span class="st">"N"</span><span class="op">)</span>
<span class="co">#select the useful information for scPagwas.</span>
<span class="va">gwas_data</span><span class="op">&lt;-</span><span class="va">gwas_data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chrom"</span>,<span class="st">"pos"</span>,<span class="st">"rsid"</span>,<span class="st">"beta"</span>,<span class="st">"se"</span>,<span class="st">"maf"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">gwas_data</span>,file<span class="op">=</span><span class="st">"monocytecount_gwas_data.txt"</span>,row.names<span class="op">=</span><span class="cn">F</span>,quote<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="pathway-gene-list">3.Pathway gene list<a class="anchor" aria-label="anchor" href="#pathway-gene-list"></a>
</h3>
<p>There are some processed pathway gene list provided by scPagwas package: all these pathway list are including gene symbols.</p>
<ul>
<li>Genes_by_pathway_kegg</li>
<li>genes.by.celltype.pathway</li>
<li>genes.by.gpbp.pathway</li>
<li>genes.by.reactome.pathway</li>
<li>genes.by.regulatory.pathway</li>
<li>genes.by.tft.pathway</li>
<li>genes.by.hallmark.pathway</li>
<li>genes.by.immunologic.pathway</li>
<li>genes.by.immunesigdb.pathway</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Genes_by_pathway_kegg</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="co">#&gt; $hsa00010</span>
<span class="co">#&gt;  [1] "HK3"     "HK1"     "HK2"     "HKDC1"   "GCK"     "GPI"     "PFKM"   </span>
<span class="co">#&gt;  [8] "PFKP"    "PFKL"    "FBP1"    "FBP2"    "ALDOC"   "ALDOA"   "ALDOB"  </span>
<span class="co">#&gt; [15] "TPI1"    "GAPDH"   "GAPDHS"  "PGK2"    "PGK1"    "PGAM1"   "PGAM2"  </span>
<span class="co">#&gt; [22] "PGAM4"   "ENO3"    "ENO2"    "ENO1"    "ENO4"    "PKM"     "PKLR"   </span>
<span class="co">#&gt; [29] "PDHA2"   "PDHA1"   "PDHB"    "DLAT"    "DLD"     "LDHAL6A" "LDHAL6B"</span>
<span class="co">#&gt; [36] "LDHA"    "LDHB"    "LDHC"    "ADH1A"   "ADH1B"   "ADH1C"   "ADH7"   </span>
<span class="co">#&gt; [43] "ADH4"    "ADH5"    "ADH6"    "AKR1A1"  "ALDH2"   "ALDH3A2" "ALDH1B1"</span>
<span class="co">#&gt; [50] "ALDH7A1" "ALDH9A1" "ALDH3B1" "ALDH3B2" "ALDH3A1" "ACSS1"   "ACSS2"  </span>
<span class="co">#&gt; [57] "GALM"    "PGM1"    "PGM2"    "G6PC1"   "G6PC2"   "G6PC3"   "ADPGK"  </span>
<span class="co">#&gt; [64] "BPGM"    "MINPP1"  "PCK1"    "PCK2"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $hsa00020</span>
<span class="co">#&gt;  [1] "CS"     "ACLY"   "ACO2"   "ACO1"   "IDH1"   "IDH2"   "IDH3B"  "IDH3G" </span>
<span class="co">#&gt;  [9] "IDH3A"  "OGDHL"  "OGDH"   "DLST"   "DLD"    "SUCLG1" "SUCLG2" "SUCLA2"</span>
<span class="co">#&gt; [17] "SDHA"   "SDHB"   "SDHC"   "SDHD"   "FH"     "MDH1"   "MDH2"   "PC"    </span>
<span class="co">#&gt; [25] "PCK1"   "PCK2"   "PDHA2"  "PDHA1"  "PDHB"   "DLAT"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $hsa00030</span>
<span class="co">#&gt;  [1] "GPI"     "G6PD"    "PGLS"    "H6PD"    "PGD"     "RPE"     "RPEL1"  </span>
<span class="co">#&gt;  [8] "TKT"     "TKTL2"   "TKTL1"   "TALDO1"  "RPIA"    "DERA"    "RBKS"   </span>
<span class="co">#&gt; [15] "PGM1"    "PGM2"    "PRPS1L1" "PRPS2"   "PRPS1"   "RGN"     "IDNK"   </span>
<span class="co">#&gt; [22] "GLYCTK"  "ALDOC"   "ALDOA"   "ALDOB"   "FBP1"    "FBP2"    "PFKM"   </span>
<span class="co">#&gt; [29] "PFKP"    "PFKL"</span></code></pre></div>
<p>There are some steps for get these pathway gene list: There is no need to repeat running these code.</p>
<div class="section level4">
<h4 id="kegg-pathway-list">KEGG pathway list<a class="anchor" aria-label="anchor" href="#kegg-pathway-list"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">KEGGREST</span><span class="op">)</span>
<span class="va">pathways.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/KEGGREST/man/keggList.html" class="external-link">keggList</a></span><span class="op">(</span><span class="st">"pathway"</span>, <span class="st">"hsa"</span><span class="op">)</span>
<span class="co"># Pull all genes for each pathway</span>
<span class="va">pathway.codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"path:"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pathways.list</span><span class="op">)</span><span class="op">)</span> 
<span class="va">genes.by.pathway_kegg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pathways.list</span>,
                           <span class="kw">function</span><span class="op">(</span><span class="va">pwid</span><span class="op">)</span><span class="op">{</span>
                             <span class="va">pw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/KEGGREST/man/keggGet.html" class="external-link">keggGet</a></span><span class="op">(</span><span class="va">pwid</span><span class="op">)</span>
                             <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">pw</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">GENE</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>
                             <span class="va">pw2</span> <span class="op">&lt;-</span> <span class="va">pw</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">GENE</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="co"># may need to modify this to c(FALSE, TRUE) for other organisms</span>
                             <span class="va">pw2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">pw2</span>, split <span class="op">=</span> <span class="st">";"</span>, fixed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
                             <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pw2</span><span class="op">)</span>
                           <span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="other-pathway-list">Other pathway list<a class="anchor" aria-label="anchor" href="#other-pathway-list"></a>
</h4>
<p>These pathways data are download from <a href="https://www.gsea-msigdb.org/gsea/index.jsp" class="external-link">GSEA</a> website.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c8.all.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.celltype.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c3.tft.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.tft.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c5.go.bp.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.gpbp.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c3.all.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.regulatory.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"h.all.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.hallmark.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c2.cp.reactome.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.reactome.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">genes.by.reactome.pathway</span>,file <span class="op">=</span> <span class="st">"genes.by.reactome.pathway.RData"</span><span class="op">)</span>

<span class="co">#all immunologic signature gene sets as Gene Symbols</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c7.all.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.immunologic.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="co">#ImmuneSigDB gene sets as Gene Symbols</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c7.immunesigdb.v7.5.1.symbols.gmt"</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">genes.by.immunesigdb.pathway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"["</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Note:</p>
<ol style="list-style-type: decimal">
<li>Sometimes, there is no need to change the pathway list frequently once you choose a fitable pathway list.</li>
<li>The summed number of genes in pathway list should not too much to cost a long time or memory.Once your pathway list is too big, you can choose some sub-pathway suitable for you analysisi or remove some redundance pathways.</li>
</ol>
</div>
<div class="section level4">
<h4 id="reduce-pathway-gene-list">Reduce pathway gene list<a class="anchor" aria-label="anchor" href="#reduce-pathway-gene-list"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes.by.reactome.pathway</span><span class="op">)</span>
<span class="co">#&gt; [1] 1615</span>
 <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">genes.by.reactome.pathway</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 89476</span></code></pre></div>
<p>We set the <code>genes.by.reactome.pathway</code> for example, there are 1615 gene list and 89476 genes, a mount of resouces and time will be cost when running scPagwas, we provid <code>reduce_pathway</code> to reduce the pathway list:</p>
<ul>
<li>
<code>pathway_seed</code> choose a list of pathway names as seed, which are some pahtways cann’t be remove.</li>
<li>
<code>remove_proporion</code> The propotion of duplicated between seed pathway and the others</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reduce_genes.by.reactome.pathway</span><span class="op">&lt;-</span><span class="fu">scPagwas</span><span class="fu">::</span><span class="fu"><a href="../reference/reduce_pathway.html">reduce_pathway</a></span><span class="op">(</span>pathway_seed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">genes.by.reactome.pathway</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes.by.reactome.pathway</span><span class="op">)</span>,<span class="fl">500</span><span class="op">)</span><span class="op">]</span>,
                                                 pathway_list<span class="op">=</span><span class="va">genes.by.reactome.pathway</span>,
                                                 remove_proporion<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">reduce_genes.by.reactome.pathway</span><span class="op">)</span>
<span class="co">#[1] 1045</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">reduce_genes.by.reactome.pathway</span><span class="op">)</span><span class="op">)</span>
<span class="co">#[1] 34980</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="gene-block-annotation">4.Gene block annotation<a class="anchor" aria-label="anchor" href="#gene-block-annotation"></a>
</h3>
<p>Gene block annotation in chromosome is need to prepare for scPagwas. scPagwas can provide a block annotation data for protein-coding genes.</p>
<p>the processed block annotation data are show here:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scPagwas</span><span class="op">)</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">block_annotation</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">chrom</th>
<th align="right">start</th>
<th align="right">end</th>
<th align="left">label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">chr1</td>
<td align="right">11869</td>
<td align="right">14409</td>
<td align="left">DDX11L1</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">chr1</td>
<td align="right">14404</td>
<td align="right">29570</td>
<td align="left">WASH7P</td>
</tr>
<tr class="odd">
<td align="left">26</td>
<td align="left">chr1</td>
<td align="right">17369</td>
<td align="right">17436</td>
<td align="left">MIR6859-1</td>
</tr>
<tr class="even">
<td align="left">29</td>
<td align="left">chr1</td>
<td align="right">29554</td>
<td align="right">31109</td>
<td align="left">MIR1302-2HG</td>
</tr>
<tr class="odd">
<td align="left">37</td>
<td align="left">chr1</td>
<td align="right">30366</td>
<td align="right">30503</td>
<td align="left">MIR1302-2</td>
</tr>
<tr class="even">
<td align="left">40</td>
<td align="left">chr1</td>
<td align="right">34554</td>
<td align="right">36081</td>
<td align="left">FAM138A</td>
</tr>
</tbody>
</table>
<p>Here is the procedure of obtaining the data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"rtracklayer"</span><span class="op">)</span>
<span class="va">gtf_df</span><span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu">import</span><span class="op">(</span><span class="st">"gencode.v34.annotation.gtf.gz"</span><span class="op">)</span>
<span class="va">gtf_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gtf</span><span class="op">)</span>
<span class="va">gtf_df</span> <span class="op">&lt;-</span> <span class="va">gtf_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqnames"</span>,<span class="st">"start"</span>,<span class="st">"end"</span>,<span class="st">"type"</span>,<span class="st">"gene_name"</span><span class="op">)</span><span class="op">]</span>
<span class="va">gtf_df</span> <span class="op">&lt;-</span> <span class="va">gtf_df</span><span class="op">[</span><span class="va">gtf_df</span><span class="op">$</span><span class="va">type</span><span class="op">==</span><span class="st">"gene"</span>,<span class="op">]</span>
<span class="va">block_annotation</span><span class="op">&lt;-</span><span class="va">gtf_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">block_annotation</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chrom"</span>, <span class="st">"start"</span>,<span class="st">"end"</span>,<span class="st">"label"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ld-data">5.LD data<a class="anchor" aria-label="anchor" href="#ld-data"></a>
</h3>
<p>The 1,000 Genomes Project Phase 3 Panel was applied to calculate the linkage disequilibrium (LD) among SNPs extracted from GWAS summary statistics. the processed LD data are show here:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scPagwas</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">chrom_ld</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chrom_ld</span><span class="op">[[</span><span class="st">"chr1"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">SNP_A</th>
<th align="left">SNP_B</th>
<th align="right">R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rs548419688</td>
<td align="left">rs568405545</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="left">rs575272151</td>
<td align="left">rs544419019</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="left">rs62635286</td>
<td align="left">rs200579949</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="left">rs531646671</td>
<td align="left">rs541940975</td>
<td align="right">1.000000</td>
</tr>
<tr class="odd">
<td align="left">rs564003018</td>
<td align="left">rs374029747</td>
<td align="right">0.580208</td>
</tr>
<tr class="even">
<td align="left">rs565824523</td>
<td align="left">rs528394432</td>
<td align="right">1.000000</td>
</tr>
</tbody>
</table>
<p>We use <code>vcftools</code> and <code>plink</code> to deal with the 1,000 Genomes genotypes.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./vcftools</span> <span class="at">--vcf</span> ./1000genomes_all_genotypes.vcf <span class="at">--plink-tped</span> <span class="at">--out</span> ./1000genomes_all_genotypes</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./plink</span> <span class="at">--tfile</span> ./1000genomes_all_genotypes <span class="at">--recode</span> <span class="at">--out</span> ./1000genomes_all_genotypes</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="ex">./plink</span> <span class="at">--map</span> ./1000genomes_all_genotypes.map <span class="at">--ped</span> ./1000genomes_all_genotypes.ped <span class="at">--allow-no-sex</span> <span class="at">--autosome</span> <span class="at">--r2</span> <span class="at">--ld-window-kb</span> 1000 <span class="at">--ld-window-r2</span> 0.2 <span class="at">--out</span> ./ld_1000genome</span></code></pre></div>
<p>R environment to print out the scPagwas-needed data.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>covid_ld<span class="ot">&lt;-</span><span class="fu">read.delim</span>(<span class="st">"./ld_1000genome.ld"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#remove sex chrome</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>covid_ld<span class="ot">&lt;-</span>covid_ld[<span class="sc">!</span>(covid_ld<span class="sc">$</span> <span class="sc">%in%</span> <span class="dv">23</span>),]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(covid_ld)[<span class="dv">7</span>]<span class="ot">&lt;-</span><span class="st">"R"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print out the result in chrom number</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">unique</span>(covid_ld<span class="sc">$</span>CHR_A), <span class="cf">function</span>(i){</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">data.table</span>(covid_ld[covid_ld<span class="sc">$</span>CHR_A <span class="sc">==</span> i,])</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  file_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"./LD/"</span>,i,<span class="st">".Rds"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(a, <span class="at">file =</span> file_name)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">#integrate the data</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>chrom_ld<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>),<span class="cf">function</span>(chrom){</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  chrom_ld_file_path <span class="ot">&lt;-</span> <span class="fu">paste</span>(ld_folder, <span class="st">'/'</span>, chrom, <span class="st">'.Rds'</span>, <span class="at">sep =</span> <span class="st">''</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a> ld_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(chrom_ld_file_path)[(R<span class="sc">**</span><span class="dv">2</span> <span class="sc">&gt;</span> r2_threshold), .(SNP_A, SNP_B, R)]</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ld_data)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Chunyu Deng.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
